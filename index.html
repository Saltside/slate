<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Slate by trobrock</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Slate</h1>
        <p>Simple wrapper around the graphite render api</p>

        <p class="view"><a href="https://github.com/trobrock/slate">View the Project on GitHub <small>trobrock/slate</small></a></p>


        <ul>
          <li><a href="https://github.com/trobrock/slate/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/trobrock/slate/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/trobrock/slate">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>Slate</h1>

<p><a href="http://travis-ci.org/trobrock/slate"><img src="https://secure.travis-ci.org/trobrock/slate.png" alt="Build Status"></a>
<a href="https://gemnasium.com/trobrock/slate"><img src="https://gemnasium.com/trobrock/slate.png" alt="Dependency Status"></a></p>

<p>Simple wrapper to the Graphite render api</p>

<h2>Installation</h2>

<p>Add this line to your application's Gemfile:</p>

<pre><code>gem 'slate'
</code></pre>

<p>And then execute:</p>

<pre><code>$ bundle
</code></pre>

<p>Or install it yourself as:</p>

<pre><code>$ gem install slate
</code></pre>

<h2>Usage</h2>

<h3>Configuration</h3>

<p>Configure the Slate client</p>

<div class="highlight"><pre><span class="no">Slate</span><span class="o">.</span><span class="n">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="s2">"http://your.graphite-server.com"</span>
<span class="k">end</span>
</pre></div>

<h3>Ruby interface</h3>

<p>To build a basic graph</p>

<div class="highlight"><pre><span class="n">graph</span> <span class="o">=</span> <span class="ss">Slate</span><span class="p">:</span><span class="ss">:Graph</span><span class="o">.</span><span class="n">new</span>
<span class="n">graph</span> <span class="o">&lt;&lt;</span> <span class="ss">Slate</span><span class="p">:</span><span class="ss">:Target</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s2">"stats.web01.load"</span><span class="p">)</span>

<span class="nb">puts</span> <span class="n">graph</span><span class="o">.</span><span class="n">url</span>
<span class="nb">puts</span> <span class="n">graph</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="ss">:json</span><span class="p">)</span>
</pre></div>

<p>Adjust the timeframe of the graph</p>

<div class="highlight"><pre><span class="n">graph</span>       <span class="o">=</span> <span class="ss">Slate</span><span class="p">:</span><span class="ss">:Graph</span><span class="o">.</span><span class="n">new</span>
<span class="n">graph</span><span class="o">.</span><span class="n">from</span>  <span class="o">=</span> <span class="s2">"-1w"</span>
<span class="n">graph</span><span class="o">.</span><span class="n">until</span> <span class="o">=</span> <span class="s2">"-1d"</span>
<span class="n">graph</span> <span class="o">&lt;&lt;</span> <span class="ss">Slate</span><span class="p">:</span><span class="ss">:Target</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s2">"stats.web01.load"</span><span class="p">)</span>
</pre></div>

<p>Use functions</p>

<div class="highlight"><pre><span class="n">graph</span> <span class="o">=</span> <span class="ss">Slate</span><span class="p">:</span><span class="ss">:Graph</span><span class="o">.</span><span class="n">new</span>

<span class="n">graph</span> <span class="o">&lt;&lt;</span> <span class="ss">Slate</span><span class="p">:</span><span class="ss">:Target</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s2">"stats.web01.load"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">target</span><span class="o">|</span>
  <span class="n">target</span><span class="o">.</span><span class="n">add_function</span> <span class="ss">:sum</span>
  <span class="n">target</span><span class="o">.</span><span class="n">add_function</span> <span class="ss">:alias</span><span class="p">,</span> <span class="s2">"load"</span>
<span class="k">end</span>
</pre></div>

<p>Or more complex targets (like passing targets to other targets): <a href="https://github.com/trobrock/slate/blob/master/spec/slate/graph_spec.rb">Graph Spec</a></p>

<h3>Slate text interface</h3>

<p>Slate also provides a text interface for building targets, this can be useful if you want to enable users to create graphs.
This text interface also support being able to pass targets as arguments to functions, like you need for the <code>asPercentOf</code> function.</p>

<div class="highlight"><pre><span class="n">graph</span> <span class="o">=</span> <span class="ss">Slate</span><span class="p">:</span><span class="ss">:Graph</span><span class="o">.</span><span class="n">new</span>

<span class="n">target</span> <span class="o">=</span> <span class="o">&lt;&lt;-</span><span class="no">SLATE</span>
<span class="sh">"stats.web1.load" {</span>
<span class="sh">  sum</span>
<span class="sh">  alias "load"</span>
<span class="sh">}</span>
<span class="no">SLATE</span>

<span class="n">graph</span> <span class="o">&lt;&lt;</span> <span class="ss">Slate</span><span class="p">:</span><span class="ss">:Parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</pre></div>

<p>Full test cases for different things this syntax supports are here: <a href="https://github.com/trobrock/slate/blob/master/spec/slate/parser_spec.rb">Parser Spec</a></p>

<h3>Calculations</h3>

<p>Slate supports things call Calculations, which take in graphite data and boil them down to single numbers, this can be useful if you wanted to calculate the average load over the week for all your servers.</p>

<div class="highlight"><pre><span class="n">graph</span> <span class="o">=</span> <span class="ss">Slate</span><span class="p">:</span><span class="ss">:Graph</span><span class="o">.</span><span class="n">new</span>
<span class="n">graph</span> <span class="o">&lt;&lt;</span> <span class="ss">Slate</span><span class="p">:</span><span class="ss">:Target</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s2">"stats.web01.load"</span><span class="p">)</span>

<span class="nb">p</span> <span class="ss">Slate</span><span class="p">:</span><span class="ss">:Calculation</span><span class="o">::</span><span class="no">Mean</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
<span class="c1"># [{ "name" =&gt; "stats.web01.load", "value" =&gt; 1.5 }]</span>
</pre></div>

<p>All the possible calculation classes are <a href="https://github.com/trobrock/slate/tree/master/lib/slate/calculation">here</a>.</p>

<h2>Contributing</h2>

<ol>
<li>Fork it</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol><h2>Contributors</h2>

<p>Trae Robrock (<a href="https://github.com/trobrock">https://github.com/trobrock</a>)</p>

<p>Andrew Katz (<a href="https://github.com/andrewkatz">https://github.com/andrewkatz</a>)</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/trobrock">trobrock</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>